# 6. GAN을 활용한 이상 화상 탐지

---

---

# GAN을 활용한 이상 화상 검출의 필요성

- 의료 현장에서 질환 및 건강 상태를 판별하거나 제조업에서 이상이 있는 부품을 검출할 때 필요
- 이상 화상이 정상 화상보다 매우 적어 이상 화상과 정상 화상의 비율이 안 맞을 수 있음
- 이러한 문제 때문에 정상 화상으로만 딥러닝을 실시하여 이상 화상을 검출하는 알고리즘을 구축해야 하는 과제가 생김 → AnoGAN을 이용하여 해결함

# AnoGAN 개요

- ‘정답 화상을 생성한 GAN 모델을 구축하고 판정할 테스트 화상을 해당 식별기에 투입하여 테스트 화상이 지도 데이터(정상 화상)인지 가짜 화상 인지를 판정한다는 전략
- 식별기 D뿐만 아니라 생성기 G도 활용하여 이상 탐지를 수행하는 것이 이번 장에서 다룰 AnoGAN 등의 GAN을 활용한 이상 탐지 기법

# AnoGAN의 손실함수

- 생성된 화상 및 테스트 화상의 채널별로 각 픽셀의 차이를 찾아 그 절댓값의 픽셀 합을 손실로 설정 할 수 있음 → residual loss라고 칭함
- 테스트 화상과 생성된 화상을 식별기 D에 입력하여 진위 여부를 판정하는 마지막 전결합 층의 하나 앞의 특징량을 활용 함
- 식별기 D에서 테스트 화상과 생성 화상의 특징량에 대한 픽셀 수준은 어떠한지 그 차이를 계산함 → discrimination loss라고 칭함

$$
loss = (1-\lambda) * residual\;loss + \lambda * discrimination\;loss
$$

- $\lambda$는 residual loss와 discrimination loss의 균형을 조절하는 변수
